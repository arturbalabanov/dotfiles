#!/bin/bash

SCRIPTS_DIR="$(dirname "$(readlink -f "$0")")"
INCLUDE_DIR="$SCRIPTS_DIR/include"

source "$SCRIPTS_DIR/common.sh"

yadm add ~/scripts/*
yadm add ~/scripts/**/*
yadm add ~/.config/nvim/lua/user/*
yadm add ~/.config/nvim/lua/user/**/*

yadm status

read -p "Are you sure you want to commit these changes? " -n 1 -r
echo    # move to a new line
if [[ ! $REPLY =~ ^[Yy]$ ]]; then
    error "Aborted, no changes were committed"
fi

commit_msg="Updated dotfiles $(date +'%Y-%m-%d %H:%M %Z') from $(yadm config local.class)"

yadm commit -am "$commit_msg" && yadm push
