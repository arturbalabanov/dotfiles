# For the zsh theme -- if the user is DEFAULT_USER, it is not shown
export DEFAULT_USER="arturb"

export NVM_DIR="$HOME/.nvm"
[ -s "$NVM_DIR/nvm.sh" ] && . "$NVM_DIR/nvm.sh"  # This loads nvm

function venv {
    source venv/bin/activate && export PYTHONPATH=`pwd`;
}

function commit {
	branch_name=$(git rev-parse --abbrev-ref HEAD)

	commit_template=$(mktemp)
	cat >$commit_template <<-EOF
	Problem: 



	Solution: 
	EOF

	if [[ $# -eq 0 ]]; then
		commit_msg=''
		git_commit_args=''
	elif [[ $# -eq 1 ]]; then
		commit_msg=''
		git_commit_args=${@: -1}
	else
		commit_msg=${@: -1}
		git_commit_args=${@:1:$(($# - 1))}
	fi

	if [[ $branch_name =~ "^(SPORT\-[0-9]+)" ]]; then
		if [[ ! -z $commit_msg ]]; then
			commit_msg="$commit_msg ($match[1])"
		fi

		echo "\nrefs: $match[1]" >> $commit_template
	fi
	
	cmd="git commit $git_commit_args"

	if [[ -z $commit_msg ]]; then
		git commit $git_commit_args --template=$commit_template
	else
		git commit $git_commit_args "$commit_msg"
	fi

	rm $commit_template
}

function pgssh {
	server="$1"
	db_name="$2"
	username="colin"
	password="c0l1n"
	db_port="5432"
	fwd_port="9000"

	ssh -f -o ExitOnForwardFailure=yes -L ${fwd_port}:localhost:${db_port} $server \
		sleep 10

	export PGPASSWORD="$password"
	pgcli -h localhost -p $fwd_port $db_name $username
}

